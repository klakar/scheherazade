<!doctype html>
<html lang="en">
  <head>
    <meta charset="UTF-8"/>
    <link rel="stylesheet" href="http://openlayers.org/en/v3.17.1/css/ol.css" type="text/css">
    <link rel="stylesheet" href="../style/storymap.css" /><!-- Story styles -->
    <script src="http://openlayers.org/en/v3.17.1/build/ol.js" type="text/javascript"></script>
    <title>OpenLayers 3 example</title>
  </head>
  <body onload="init()">
    <div id="map" class="map"></div>
    
    <div id="title" class="storyTitle">Story Title</div>
    
    <div id="id0" class="slide"><h2>Test</h2><p class="slideContent">Detta 채r bildtexten.</p></div> <!-- Slide Div with id= "id" + currentSlide id -->
    
    <div id="id1" class="slide"><h2>Test 2</h2><p class="slideContent">Detta 채r 책x책 bildtexten.</p></div>
    
    <script type="text/javascript">
      var map = new ol.Map({
        target: 'map',
        controls: ol.control.defaults().extend([
          new ol.control.FullScreen()
        ]),
        layers: [
          new ol.layer.Tile({
            source: new ol.source.OSM()
          })
        ],
        view: new ol.View({
          center: ol.proj.fromLonLat([37.41, 8.82]), //Start Position
          zoom: 4 // Start Zoom
        })
      });
      
      function init() {
        //window.alert("Test");
        var slides = ["id0", "id1"];
        var slideZoom = [5, 11, 8]; // Zoom list
        var slidePosition = [[-50,0], [20,40], [30,-20]]; // Position list
        var currentSlide = 0;
        var titleDiv = document.getElementById("title");
        var slideDiv = document.getElementById("id0");
        slideDiv.onclick = function() {
        	 doFly([7000000,10000000], 10);
        }
        titleDiv.onclick = function() {
          for (var x = 0; x < slides.length; x++) {
            if (x == currentSlide) {
               document.getElementById(slides[x]).style.visibility = "visible";	
            } else {
            	document.getElementById(slides[x]).style.visibility = "hidden";
            }
          };
          doFly(ol.proj.fromLonLat(slidePosition[currentSlide]), slideZoom[currentSlide]);
          currentSlide += 1;
          if ( currentSlide == slides.length ) {
          	currentSlide = 0;
          }
          
          //window.alert(slides[x]);
        };
      }
      function doFly(slidePosition, slideZoom) {
        // bounce by zooming out one level and back in
        var bounce = ol.animation.bounce({
          resolution: map.getView().getResolution() * 2
        });
        // start the pan at the current center of the map
        var pan = ol.animation.pan({
          source: map.getView().getCenter()
        });
        var zoom = ol.animation.zoom({
          resolution: map.getView().getResolution()
        });
        map.beforeRender(bounce);
        map.beforeRender(pan);
        map.beforeRender(zoom);
        // when we set the center to the new location, the animated move will
        // trigger the bounce, pan and zoom effects
        map.getView().setZoom(slideZoom);
        map.getView().setCenter(slidePosition);
      }
    </script>
  </body>
</html>